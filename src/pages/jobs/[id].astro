---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { jobs } from '../../data/jobs';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = () => {
  return jobs.map((job) => ({
    params: { id: job.id },
    props: { job },
  }));
};

const { job } = Astro.props;
---

<BaseLayout title={`${job.title} (${job.countryName}) — AMBITIA`} description={job.description}>
  <section class="py-12 px-4">
    <div class="max-w-3xl mx-auto">
      <!-- Back link -->
      <a href="/jobs" class="btn btn-ghost btn-sm mb-6 gap-1">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        Retour aux postes
      </a>

      <!-- Header -->
      <h1 class="text-3xl md:text-4xl font-bold text-base-content mb-4">{job.title}</h1>

      <!-- Badges -->
      <div class="flex flex-wrap gap-2 mb-8">
        <span class="badge badge-lg badge-outline gap-1">
          <span class="text-base">{job.countryFlag}</span>
          {job.countryName}
        </span>
        <span class="badge badge-lg badge-outline">{job.location}</span>
        <span class="badge badge-lg badge-outline">{job.contract_type}</span>
        <span class="badge badge-lg badge-primary font-semibold">{job.salary_label}</span>
      </div>

      <!-- Description -->
      <div class="mb-8">
        <h2 class="text-xl font-semibold text-base-content mb-3">Description du poste</h2>
        <p class="text-base-content/80 leading-relaxed">{job.description}</p>
      </div>

      <!-- Requirements -->
      <div class="mb-8">
        <h2 class="text-xl font-semibold text-base-content mb-3">Compétences requises</h2>
        <ul class="space-y-2">
          {job.requirements.map((req: string) => (
            <li class="flex items-start gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-accent mt-0.5 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
              <span class="text-base-content/80">{req}</span>
            </li>
          ))}
        </ul>
      </div>

      <!-- Contract info -->
      <div class="bg-base-200 rounded-xl p-6 mb-8">
        <h2 class="text-xl font-semibold text-base-content mb-4">Conditions</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <p class="text-sm text-base-content/50">Pays</p>
            <p class="font-medium text-base-content">{job.countryFlag} {job.countryName}</p>
          </div>
          <div>
            <p class="text-sm text-base-content/50">Localisation</p>
            <p class="font-medium text-base-content">{job.location}</p>
          </div>
          <div>
            <p class="text-sm text-base-content/50">Salaire</p>
            <p class="font-medium text-base-content">{job.salary_label}</p>
          </div>
          <div>
            <p class="text-sm text-base-content/50">Type de contrat</p>
            <p class="font-medium text-base-content">{job.contract_type}</p>
          </div>
        </div>
      </div>

      <!-- CTA -->
      <div class="text-center">
        <a href={`/apply/${job.id}`} class="btn btn-primary btn-lg">
          Postuler
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
